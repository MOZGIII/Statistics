
<% require 'yaml' %>

<% global = YAML.load_file("data/global.yaml") %>
<% data = YAML.load_file("data/#{global['variant']}.yaml") %>

<% require './statistic.rb' %>
<% require './latex_helper.rb' %>
<% include LatexHelper %>

<%
sample = {}
for i in 1 .. 4
  sample[i] = Statistic::Sample::new(data[i]['data'])
  sample[i].hist_step = data[i]['histstep'] if data[i]['histstep']
  sample[i].hist_start  = data[i]['histstart'] if data[i]['histstart']
end
%>

\subsection*{\hspace*{\parindent}Задание 7}
Для каждой из выборок, приведенных в задании 5, с уровнем значимости 0{,}1, проверить гипотезу о том, что
вероятность $P$ появления наблюдения, превосходящего 5, равна 0{,}5 при конкурирующей гипотезе:\\
В задании 6а $H_1 : P(X>5) \neq 0{,}5$;\\
В задании 6б $H_2 : P(X>5) > 0{,}5$;\\
В задании 6в $H_3 : P(X>5) < 0{,}5$.\par

\par
{\em Решение.} 
Пусть приведено $n$ независимых испытаний Бернулли с неизвестной вероятностью 
$p$ появления события $А$ в каждом. По результатам испытаний найдена относительная 
частота $\frac{m}{n}$, где $m$~--- число появлений события $А$ в
$n$ испытаниях. Требуется по величине $\frac{m}{n}$ с уровнем значимости $\alpha$ 
проверить гипотезу $H_0$ о том, что неизвестная вероятность $р$ равна заданному 
значению $p_0$. В силу несмещенности оценки $\frac{m}{n}$ для $р$ гипотезу
$H_0$ можно переформулировать: $M(\frac{m}{n}) = p_0$. В качестве критерия 
проверки гипотезы принимается величина:
$$
U_{\text{набл}} = \dfrac{\dfrac{m}{n}-p_0}{\sqrt{p_0q_0}}\sqrt{n}\text{, где }q_0=1-p_0.
$$
Указанная величина при справедливости гипотезы $H_0$ имеет стандартное 
нормальное распределение. Правило принятия решения в зависимости от конкурирующей 
гипотезы такое же, как для гипотезы о равенстве математических
ожиданий в случае известной дисперсии, а именно:
\begin{enumerate}
 \renewcommand{\labelenumi}{\theenumi)}
 \item Конкурирующая гипотеза $H_1 : P(A) \neq p_0$. Критическая область двусторонняя с вероятностью
$\alpha/2$ попадания в каждую половину в случае справедливости $H_0$. Из уравнения
$F_{\text{ст}}(U_{\text{крит}}) = 1 - \alpha/2$, где $F_{\text{ст}}(U)$~--- функция распределения
стандартного нормального закона, отыскивается значение $U_{\text{крит}}$. Если
${|U_{\text{набл}}| \geqslant U_{\text{крит}}}$, то гипотеза $H_0$ отвергается с уровнем значимости $\alpha$.
При $|U_{\text{набл}}| < U_{\text{крит}}$ нет оснований отвергнуть гипотезу $H_0$ в пользу гипотезы $H_1$.

 \item Конкурирующая гипотеза $H_2 : P(A) > p_0$. Критическая область правосторонняя с вероятностью
$\alpha$ попадания в нее в случае справедливости $H_0$. Из уравнения
$F_{\text{ст}}(U_{\text{крит}}) = 1 - \alpha$ отыскивается значение $U_{\text{крит}}$. Если
$U_{\text{набл}} \geqslant U_{\text{крит}}$, то гипотеза $H_0$ отвергается с уровнем значимости $\alpha$.
Если $U_{\text{набл}} < U_{\text{крит}}$, то нет оснований отвергнуть $H_0$ в пользу $H_2$. Если оказалось,
что $\frac{m}{n} < p_0$, то гипотеза $H_0$ принимается сразу как более правдоподобная, чем $H_2$, так как
заведомо $U_{\text{набл}} < 0$, $U_{\text{крит}} > 0$, и условие $U_{\text{набл}} < U_{\text{крит}}$ будет
выполнено автоматически.

 \item Конкурирующая гипотеза $H_3 : P(A) < p_0$. Критическая область левосторонняя с вероятностью
$\alpha$ попадания в нее в случае справедливости $H_0$. Значение $U_{\text{крит}}$ находят из уравнения
$F_{\text{ст}}(U_{\text{крит}}) = \alpha$. При проверке гипотезы в силу симметрии стандартного нормального распределения относительно нуля используют противоположное значение $-U_{\text{крит}}$. Если
$U_{\text{набл}} \leqslant -U_{\text{крит}}$, то гипотезу $H_0$ отвергают с уровнем значимости $\alpha$ в пользу
гипотезы $H_3$, в противном случае нет оснований отвергнуть гипотезу $H_0$ в пользу $H_3$. Если оказалось, что
$m/n < p_0$, то гипотезу $H_0$ принимают сразу как более правдоподобную, чем $H_3$, без вычисления
$U_{\text{крит}}$. Действительно, заведомо $U_{\text{набл}} > 0$, $U_{\text{крит}} > 0$, $-U_{\text{крит}} < 0$
и условие $U_{\text{набл}} > -U_{\text{крит}}$ будет выполнено автоматически.
\end{enumerate}

<%
n = sample[3].size
p, q = 0.5, 1 - 0.5
m1 = sample[3].data.select { |x| x > 5 }.size
m2 = sample[4].data.select { |x| x > 5 }.size
m1n = roundn(m1.to_f/n, 6)
m2n = roundn(m2.to_f/n, 6)
u1 = roundn((m1n - p)/Math::sqrt(p*q)*Math::sqrt(n), 6)
u2 = roundn((m2n - p)/Math::sqrt(p*q)*Math::sqrt(n), 6)
z1 = roundn(Statistic::Calc::inv_laplace_function(0.95 - 0.5), 6)
z2 = roundn(Statistic::Calc::inv_laplace_function(0.9 - 0.5), 6)
%>

Пусть $А$~--- событие, состоящее в том, что выборочное значение превосходит $5$. Для каждой выборки 
$i (i=3, 4)$ вычислим частоту $m_i$ и относительную частоту $\dfrac{m_i}n$ при $n = <%= n %>$, а
затем значения критерия $U_i = \dfrac{\dfrac{m_i}{n} - p_0}{\sqrt{p_0q_0}}\cdot\sqrt{n}$.

$$
p_0 = <%= p %>; q_0 = 1 - p_0 = 1 - <%= p %> = <%= q %>.
$$

\begin{table}
\caption{Результаты расчета критерия и критические точки.}\label{tab:11}
\renewcommand{\arraystretch}{1.5}
\begin{tabular}{|c|c|c|c|c|c|} 
\hline
$i$ & $m_i$ & $\frac{m_i}{n}$ & $U_i$ & $H_1$: $U_{\text{крит}}$ & $H_2$, $H_3$: $U_{\text{крит}}$ 
\\
\hline
$3$ & $<%= roundn(m1 ,4) %>$ & <%= roundn(m1n, 4) %> & <%= roundn(u1, 4) %> & \multirow{2}{*}{<%= z1 %>} & \multirow{2}{*}{<%= z2 %>} 
\\
\cline{1-4}
$4$ & $<%= roundn(m2, 4) %>$ & <%= roundn(m2n, 4) %> & <%= roundn(u2, 4) %> & &
\\
\hline
\end{tabular}
\end{table}

Основная гипотеза $H_0$ для каждой выборки: $P(X > 5) = <%= p %>$.

\begin{enumerate}
 \renewcommand{\labelenumi}{\theenumi)}
 \item Конкурирующая гипотеза $H_1$: $P(X > 5) \neq <%= p %>$.
Вычислим $U_{\text{крит}}$ из уравнения $F_{\text{ст}}(U_{\text{крит}}) = 
1 - \dfrac{\alpha}2$; при $\alpha = <%= 0.1 %>$ $U_{\text{крит}} = <%= z1 %>$. 

<% if u1.abs >= z1%>
	Так как $|U_3| = <%= u1.abs %> \geqslant <%= z1 %> = U_{\text{крит}}$,
	то для выборки 3 отвергаем гипотезу $H_0$ с уровнем значимости $<%= 0.1 %>$ 
	в пользу гипотезы $H_1$: вероятность того, что $X > 5$, значимо отличается от 0{,}5. 
<% else %>
	Так как $|U_3| = <%= u1.abs %> < <%= z1 %> = U_{\text{крит}}$,
	то для выборки 3 нет оснований отвергнуть гипотезу $H_0$ с уровнем значимости $<%= 0.1 %>$ 
	в пользу гипотезы $H_1$: вероятность того, что $X > 5$, незначимо отличается от 0{,}5. 
<% end %>

<% if u2.abs >= z1 %>
	Поскольку $|U_4| = <%= u2.abs %> \geqslant <%= z1 %> = U_{\text{крит}}$, 
	то для выборки 4 отвергаем гипотезу
	$H_0$ в пользу гипотезы $H_1$ с уровнем значимости $<%= 0.1 %>$.
<% else %>
	Поскольку $|U_4| = <%= u2.abs %> < <%= z1 %> = U_{\text{крит}}$, 
	то для выборки 4 нет оснований отвергать гипотезу
	$H_0$ в пользу гипотезы $H_1$ с уровнем значимости $<%= 0.1 %>$.
<% end %>

\item Конкурирующая гипотеза $H_2$: $P(X > 5) > <%= p %>$.
Вычислим $U_{\text{крит}}$ из уравнения $F_{\text{ст}}(U_{\text{крит}}) = 1 - \alpha$.
При $\alpha = <%= 0.1 %>$ $U_{\text{крит}} = <%= z2 %>$.

<% if u1 >= z2 %>
	Для выборки 3 $U_3 = <%= u1 %> \geqslant <%= z2 %> = U_{\text{крит}}$, поэтому отвергаем $H_0$ 
	в пользу $H_2$ с уровнем значимости $\alpha = 0{,}1$.
<% else %>
	Для выборки 3 $U_3 = <%= u1 %> < <%= z2 %> = U_{\text{крит}}$, поэтому нет оснований отвергнуть гипотезу $H_0$ 
	в пользу $H_2$ с уровнем значимости $\alpha = 0{,}1$.
<% end %>

<% if u2 >= z2 %>
	Для выбороки 4 $U_4 = <%= u2 %> \geqslant <%= z2 %> = U_{\text{крит}}$, поэтому отвергаем гипотезу $H_0$ 
	в пользу $H_2$ с уровнем значимости $\alpha = 0{,}1$.
<% else %>
	Для выбороки 4 $U_4 = <%= u2 %> \geqslant <%= z2 %> = U_{\text{крит}}$, поэтому нет оснований отвергнуть гипотезу$H_0$ 
	в пользу $H_2$ с уровнем значимости $\alpha = 0{,}1$.
<% end %>

\item Конкурирующая гипотеза $H_3$: $P(X > 5) < <%= p %>$.
<% if u1 <= -z2 %>
	Для выборки 3 $U_3 = <%= u1 %> \leqslant <%= -z2 %> = -U_{\text{крит}}$, поэтому отвергаем гипотезу $H_0$ 
	в пользу $H_3$ с уровнем значимости $\alpha = 0{,}1$.
<% else %>
	Для выборки 3 $U_3 = <%= u1 %> < <%= -z2 %> = -U_{\text{крит}}$, поэтому нет оснований отвергнуть гипотезугипотезу $H_0$ 
	в пользу $H_3$ с уровнем значимости $\alpha = 0{,}1$.
<% end %>

<% if u2 > -z2%>
	Для выборки 4 $U_4 = <%= u2 %> > <%= -z2 %> = -U_{\text{крит}}$, поэтому нет оснований отвергнуть гипотезу $H_0$ 
	в пользу $H_3$ с уровнем значимости $\alpha = 0{,}1$.
<% else %>
	Для выборки 4 $U_4 = <%= u2 %> \leqslant <%= -z2 %> = -U_{\text{крит}}$, поэтому отвергаем гипотезу $H_0$ 
	в пользу $H_3$ с уровнем значимости $\alpha = 0{,}1$.
<% end %>
\end{enumerate}
\endinput

